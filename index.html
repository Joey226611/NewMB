
<!doctype html>
<html lang="nl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Music Bingo — Joey</title>
<style>
:root{
  --bg1:#0a0a23;
  --accent:#7c3aed;
  --accent2:#06b6d4;
  --text:#fff;
  --muted:rgba(255,255,255,0.7);
}
*{box-sizing:border-box; margin:0; padding:0;}
html, body{height:100%; font-family: 'Inter', system-ui, sans-serif; background: linear-gradient(180deg, #0a0a23, #03031b); color: var(--text);}
.container{max-width:1000px; margin:40px auto; padding:20px; display:flex; flex-wrap:wrap; gap:20px; justify-content:center;}
.card{background:rgba(255,255,255,0.03); border:1px solid rgba(255,255,255,0.05); border-radius:16px; padding:20px; flex:1 1 400px; min-width:320px; backdrop-filter: blur(12px);}
h1{font-size:24px; margin-bottom:12px;}
button{padding:12px 18px; border:none; border-radius:12px; font-weight:700; cursor:pointer; background: linear-gradient(90deg,var(--accent),var(--accent2)); color:#fff; transition: all 0.3s ease;}
button:hover{transform: scale(1.05);}
.controls{display:flex; gap:12px; flex-wrap:wrap; margin-top:12px;}
.status{margin-top:10px; color:var(--muted); font-size:14px;}
.big{font-size:36px; font-weight:800; text-align:center;}
canvas{width:100%; height:250px; border-radius:12px; display:block; margin-top:20px; background:#02021a;}
</style>
</head>
<body>
<div class="container">
  <div class="card">
    <h1>Music Bingo — Host</h1>
    <div class="big" id="playedCount">0</div>
    <div class="status" id="totalCount">/ 0</div>
    <div class="controls">
      <button id="startBtn">Start</button>
      <button id="stopBtn">Stop</button>
      <button id="resetBtn">Reset</button>
    </div>
    <div class="status">Shortcuts: Spatie/S = Start • Esc/X = Stop • R = Reset</div>
  </div>
  <div class="card">
    <h1>Visualizer</h1>
    <canvas id="visual"></canvas>
  </div>
</div>
<script>
const mainMusicFilename = 'Music/main_lofi.mp3';
const tracks = [
  'Music/song1.mp3',
  'Music/song2.mp3',
  'Music/song3.mp3',
  'Music/song4.mp3',
  'Music/song5.mp3',
  'Music/song6.mp3',
  'Music/song7.mp3',
  'Music/song8.mp3',
  'Music/song9.mp3',
  'Music/song10.mp3',
  'Music/song11.mp3',
  'Music/song12.mp3',
  'Music/song13.mp3',
  'Music/song14.mp3',
  'Music/song15.mp3',
  'Music/song16.mp3',
  'Music/song17.mp3',
  'Music/song18.mp3',
];
let played = [];
let remaining = tracks.slice();
let mainAudio = new Audio(mainMusicFilename);
mainAudio.loop = true;
mainAudio.volume = 0.3;
let gameAudio = new Audio();
let isPlayingGame = false;
const playedCountEl = document.getElementById('playedCount');
const totalCountEl = document.getElementById('totalCount');
const startBtn = document.getElementById('startBtn');
const stopBtn = document.getElementById('stopBtn');
const resetBtn = document.getElementById('resetBtn');

const canvas = document.getElementById('visual');
const ctx = canvas.getContext('2d');
let audioCtx, analyser, dataArray, rafId;

totalCountEl.textContent = '/ ' + tracks.length;
playedCountEl.textContent = played.length;

function pickRandomTrack(){
  if(remaining.length===0) return null;
  const idx = Math.floor(Math.random()*remaining.length);
  const t = remaining.splice(idx,1)[0];
  played.push(t);
  playedCountEl.textContent = played.length;
  return t;
}

function startRound(){
  if(!audioCtx){ initAudioContext(); }
  if(isPlayingGame) return;
  const track = pickRandomTrack();
  if(!track){ alert('Alle nummers gespeeld!'); return; }
  isPlayingGame=true;
  mainAudio.pause();
  gameAudio.src = track;
  gameAudio.volume=1;
  gameAudio.play();
  gameAudio.onended=()=>{
    mainAudio.play();
    isPlayingGame=false;
  };
}

function stopRound(){
  gameAudio.pause();
  gameAudio.currentTime=0;
  mainAudio.play();
  isPlayingGame=false;
}

function resetGame(){
  played=[];
  remaining=tracks.slice();
  playedCountEl.textContent = played.length;
}

startBtn.addEventListener('click', ()=>{
  if(mainAudio.paused) mainAudio.play();
  startRound();
});
stopBtn.addEventListener('click', stopRound);
resetBtn.addEventListener('click', resetGame);

// Visualizer
function initAudioContext(){
  audioCtx = new (window.AudioContext||window.webkitAudioContext)();
  analyser = audioCtx.createAnalyser(); analyser.fftSize=256;
  dataArray = new Uint8Array(analyser.frequencyBinCount);
  const sourceMain = audioCtx.createMediaElementSource(mainAudio);
  const sourceGame = audioCtx.createMediaElementSource(gameAudio);
  const gain = audioCtx.createGain(); gain.gain.value=1;
  sourceMain.connect(analyser);
  sourceGame.connect(analyser);
  analyser.connect(audioCtx.destination);
  drawVisualizer();
}

function drawVisualizer(){
  const w=canvas.width, h=canvas.height;
  ctx.clearRect(0,0,w,h);
  analyser.getByteFrequencyData(dataArray);
  const bars=12;
  const cx=w/2, cy=h/2;
  for(let i=0;i<bars;i++){
    const val=dataArray[Math.floor(i*(dataArray.length/bars))]/255;
    const radius=30+val*100;
    const angle=(i/bars)*Math.PI*2;
    const x=cx+Math.cos(angle)*60;
    const y=cy+Math.sin(angle)*60;
    ctx.beginPath();
    ctx.arc(x,y,radius*0.1,0,Math.PI*2);
    ctx.fillStyle=`rgba(${Math.floor(124+val*130)},${Math.floor(58+val*150)},${Math.floor(237-val*120)},${0.5+val*0.5})`;
    ctx.fill();
  }
  rafId=requestAnimationFrame(drawVisualizer);
}

window.addEventListener('resize', ()=>{ canvas.width=canvas.clientWidth; canvas.height=canvas.clientHeight; });
canvas.width=canvas.clientWidth; canvas.height=canvas.clientHeight;
</script>
</body>
</html>
